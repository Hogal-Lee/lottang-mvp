:root{
  --header-h:56px;
  --toolbar-h:48px;
  --legend-h:32px;
  --bg:#111; --fg:#fff;
}

*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;background:#f6f7f9;color:#222}

/* 헤더 */
.topbar{
  position:sticky;top:0;z-index:30;
  height:var(--header-h);display:flex;align-items:center;justify-content:center;
  background:var(--bg);color:var(--fg);border-bottom:1px solid #000;
}
.topbar h1{font-size:18px;margin:0}

/* 툴바: 가로 스크롤 */
.toolbar{
  position:sticky;top:var(--header-h);z-index:25;
  display:flex;gap:8px;align-items:center;
  overflow-x:auto;white-space:nowrap;
  padding:6px 10px;background:#fff;border-bottom:1px solid #e5e7eb;
}
.toolbar input[type="text"], .toolbar input[type="search"], .toolbar #q{
  height:32px;padding:0 8px;border:1px solid #e5e7eb;border-radius:6px;min-width:160px
}
.toolbar button, .toolbar select{
  height:32px;padding:0 10px;border:1px solid #e5e7eb;border-radius:6px;background:#fff
}

/* 범례 */
.legend{
  position:sticky;top:calc(var(--header-h) + var(--toolbar-h));
  z-index:20;background:#fff;border-bottom:1px solid #e5e7eb;
  height:var(--legend-h);display:flex;align-items:center;gap:14px;padding:0 10px
}
.legend .dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;vertical-align:middle}
.dot-red{background:#ff4d4f}.dot-orange{background:#f59e0b}.dot-gray{background:#9ca3af}
.legend .count{margin-left:auto;color:#6b7280}

/* 지도 영역: 모바일에서 100dvh(주소창 포함 높이 대응) */
#map{
  position:relative;z-index:10;
  height:calc(100dvh - var(--header-h) - var(--toolbar-h) - var(--legend-h));
}

/* 바텀시트 */
.sheet{
  position:fixed;left:0;right:0;bottom:-60%;
  background:#fff;border-top-left-radius:14px;border-top-right-radius:14px;
  box-shadow:0 -10px 30px rgba(0,0,0,.12);
  transition:bottom .25s ease;z-index:40;
  max-height:75dvh;display:flex;flex-direction:column
}
.sheet.open{bottom:0}
.sheet-handle{
  width:48px;height:6px;border-radius:3px;background:#d1d5db;margin:8px auto
}
.sheet-body{padding:10px 16px;overflow:auto}
.sheet-body h2{margin:6px 0 10px;font-size:18px}
.sheet-body .meta{color:#6b7280;display:grid;gap:6px}
.sheet-body .actions{display:flex;gap:8px;margin-top:12px}
.sheet-body .actions button,.sheet-body .actions a{
  height:36px;padding:0 12px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;text-decoration:none;color:#111
}

/* 데스크탑에서 시트는 오른쪽 패널처럼 */
@media (min-width: 960px){
  .sheet{left:auto;width:360px;right:16px;bottom:16px;border-radius:12px}
  .sheet.open{bottom:16px}
}